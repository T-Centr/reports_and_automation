# reports_and_automation


## Решение задач
### Задача 1. 

Используя данные по посещаемости библиотек в районах Москвы

https://video.ittensive.com/python-advanced/data-7361-2019-11-28.utf.json

Постройте круговую диаграмму суммарной посещаемости (NumOfVisitors) 20 
наиболее популярных районов Москвы.

Создайте PDF отчет, используя файл

https://video.ittensive.com/python-advanced/title.pdf

как первую страницу. На второй странице выведите итоговую диаграмму, самый
популярный район Москвы и число посетителей библиотек в нем.

### Решение:

Подключим необходимые библиотеки reportlab, PyPDF2, requests, json, pandas,
matplotlib. Загружаем данные, сформировав get-запрос, и передаем их во 
фрейм данных, заполнив нулями отсутствующие значения. Получив значения по
районам, группируем и сортируем по числу посетителей библиотек в порядке 
убывания. Строим круговую диаграмму из двадцати самых популярных районов.
Сохраним диаграмму в файл для дальнейшей вставки в отчет. Формируем PDF 
отчет, используя файл title.pdf как первую страницу, файл с диаграммой
используем для формирования второй страницы отчета. Дополнительно выведем
информацию по самому популярному району - первому в отсортированном списке.
Это будет ответ на вопрос в задании - 765402 посетителя.

### Задача 2. Геральдические символы Москвы.

Сгенерируйте PDF документ из списка флагов и гербов районов Москвы:

https://video.ittensive.com/python-advanced/data-102743-2019-11-13.utf.csv

На каждой странице документа выведите название геральдического символа 
(Name), его описание (Description) и его изображение (Picture).

Для показа изображений используйте адрес

https://op.mos.ru/MEDIA/showFile?id=XXX

где XXX - это значение поля Picture в наборе данных. Например:

https://op.mos.ru/MEDIA/showFile?id=8466da35-6801-41a9-a71e-04b60408accb

В случае возникновения проблем с загрузкой изображений с op.mos.ru можно
добавить в код настройку для форсирования использования дополнительных 
видов шифрования в протоколе SSL/TLS.

requests.packages.urllib3.util.ssl_.DEFAULT_CIPHERS = 'ALL:@SECLEVEL=1'

### Решение:

Подключаем библиотеки pandas, pdfkit. Загружаем данные. Формируем 
постранично документ Геральдические символы Москвы с названиями округов и
описанием. Получаем 42 страницы.

### Задача 3. Многостраничный отчет.

Используя данные по активностям в парках Москвы

https://video.ittensive.com/python-advanced/data-107235-2019-12-02.utf.json

Создайте PDF отчет, в котором выведите:

1. Диаграмму распределения числа активностей по паркам, топ10 самых активных

2. Таблицу активностей по всем паркам в виде: Активность-Расписание-Парк

### Решение:

Подключаем необходимые библиотеки requests, json, pandas, matplotlib, io,
binascii, pdfkit. Загружаем данные. Сформируем набор данных из интересующих
нас колонок. Извлекаем название парка применив lambda функцию. Переименуем
колонки для отчета. Найдем активность 'Тайцзицюань' в парках Москвы. Такая
активность - одна. Сформируем диаграмму активности двадцати самых 
популярных парков в формате PDF и сохраним в файл. Формируем HTML отчет.

### Задача 4. Автоматические отчеты.

Соберите отчет по результатам ЕГЭ в 2018-2019 году, используя данные

https://video.ittensive.com/python-advanced/data-9722-2019-10-14.utf.csv

и отправьте его в HTML формате по адресу support@ittensive.com, используя 
только Python.

В отчете должно быть:

- общее число отличников (учеников, получивших более 220 баллов по ЕГЭ в 
Москве),
- распределение отличников по округам Москвы,
- название школы с лучшими результатами по ЕГЭ в Москве.

Диаграмма распределения должна быть вставлена в HTML через data:URI формат
(в base64-кодировке).

Дополнительно: приложите к отчету PDF документ того же содержания
(дублирующий письмо).

### Решение:

Импортируем необходимые модули pandas, matplotlib, pdfkit, io, binascii,
smtplib, email. Загрузим данные. Выделим результаты 2018-2019 годов. 
Выполним сортировку данных по PASSES_OVER_220. Выполним группировку по 
административным округам. Сформируем диаграмму. Сохраним в файл. Сформируем
HTML отчет со всеми данными. Отправляем отчет по адресу по адресу 
support@ittensive.com.

## Технологии в решениях
Python 3.9, Numpy, Pandas, reportlab, PyPDF2, requests, json, matplotlib,
pdfkit, io, binascii, smtplib, email.

### Студент
Валерий Калинин